function adddata(){var t=$("#Daily_DestinationId").val(),u=$("#fare").val(),f=$("#noofperson").val(),n=$("#totalamount").val(),i=$("#Daily_DestinationId option:selected").text(),r;if(n=="")return swal.fire("Cancelled","Provide all required fields before adding!","error");if(t==null||i=="Select Station")return swal.fire("Cancelled","Select destination before adding!","error");$("#dailyreporter > tbody").append("<tr><td title="+i+">"+t+"<\/td><td>"+u+"<\/td><td>"+f+"<\/td><td>"+n+'<\/td><td><button type="button" onclick="remove(this);" class="btn btn-danger btn-sm who"><i class="fa fa-trash"><\/i><\/button><\/td><\/tr>');totalbal+=Number(n);$("#totalincomebal").val(totalbal+additionincome);$("#lodgetotalincome").val(totalbal+additionincome);$("#netbalance").val(totalbal+additionincome-expenses);r=$("#totalincomebal").val();$("#Daily_Commission").val(percent/100*r);$("#fare").val("");$("#noofperson").val("");$("#totalamount").val("");$("#Daily_DestinationId").focus()}function sum(){var n=$("#fare").val(),t=$("#noofperson").val();$("#totalamount").val(n*t)}function additionalincome(){var t=$("#Daily_LoadWayBill").val(),i=$("#Daily_Lodgement").val(),n=Number(t)+Number(i),r;additionincome=n;$("#totalincomebal").val(totalbal+n);$("#netbalance").val(totalbal+n-expenses);r=$("#totalincomebal").val()}function expense(){var i,r,u,f;if(totalbal>0){var e=$("#Daily_FuelExpenditure").val(),o=$("#Daily_Commission").val(),s=$("#Daily_Repairs").val(),h=$("#Daily_OtherExpenditure").val(),c=$("#Daily_Overnith").val(),n=Number($("#totalincomebal").val()),t=$("#lodgetotalincome").val(),l=Number($("#Driver_Percent").val()),a=l/100*t;$("#Daily_DriverSavings").val(a);i=Number($("#Park_Percent").val());r=i/100*t;$("#Daily_ParkOperation").val(r);u=Number($("#Daily_DriverSavings").val());f=Number($("#Daily_ParkOperation").val());expenses=Number(e)+Number(s)+Number(h)+Number(c)+Number(o)+u+f;$("#expenditure").val(expenses);netbalan=n-expenses;$("#netbalance").val(n-expenses)}else swal.fire("Cancelled","Provide car income before adding expenditures!","error"),$("#Daily_FuelExpenditure").val(0),$("#Daily_Repairs").val(0),$("#Daily_OtherExpenditure").val(0),$("#Daily_Overnith").val(0)}function postreport(){var n={dailycomments:{},destinationRoots:[]},t;if($("#dailyreporter TBODY TR").each(function(){var i=$(this),t={};t.rootDestination=i.find("TD").eq(0).html();t.Fare=i.find("TD").eq(1).html();t.PassengerNumber=i.find("TD").eq(2).html();t.TotalAmount=i.find("TD").eq(3).html();n.destinationRoots.push(t)}),n.NoOfVehLoaded=$("#Daily_NoOfVehLoaded").val(),n.Overnith=$("#Daily_Overnith").val(),n.Trip=$("#Daily_Trip").val(),n.VehicleRegId=$("#VehicleRegId").val(),n.NoCarried=$("#Daily_NoCarried").val(),n.ReportedDate=$("#Daily_ReportedDate").val(),n.Lodgement=$("#Daily_Lodgement").val(),n.LoadWayBill=$("#Daily_LoadWayBill").val(),n.Commission=$("#Daily_Commission").val(),n.FuelExpenditure=$("#Daily_FuelExpenditure").val(),n.Repairs=$("#Daily_Repairs").val(),n.OtherExpenditure=$("#Daily_OtherExpenditure").val(),n.DriversId=$("#DriversId").val(),n.TotalIncome=$("#totalincomebal").val(),n.NetIncome=$("#netbalance").val(),n.ParkOperation=$("#Daily_ParkOperation").val(),n.DriverSavings=$("#Daily_DriverSavings").val(),n.dailycomments.fuelcomment=$("#Daily_DailyComments_FuelComment").val(),n.dailycomments.OtherComments=$("#Daily_DailyComments_OtherComments").val(),n.dailycomments.repairscomment=$("#Daily_DailyComments_RepairsComment").val(),t=0,t=$("#totalincomebal").val(),t>0){const t=Swal.mixin({customClass:{confirmButton:"btn btn-success btn-sm",cancelButton:"btn btn-danger btn-sm"},buttonsStyling:!1});t.fire({title:"Submit This Report!",text:"Confirm every information before submitting this report!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Submit!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(i=>{i.isConfirmed?$.ajax({method:"POST",url:"/api/DataReport",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:n,cache:!1,success:function(n){$.unblockUI();n.success?(t.fire("Report Information!",n.message,"success"),window.location.replace("/DailyReports/Index")):Swal.fire({icon:"error",title:"Oops...",text:n.message,footer:"Outcome Server Report"})},beforeSend:function(){blockcallback()},error:function(){$.unblockUI();Swal.fire({icon:"error",title:"Oops...",text:"Something went wrong!",footer:"Check internet connectivity"})},complete:function(){$.unblockUI()}}):i.dismiss===Swal.DismissReason.cancel&&t.fire("Cancelled","Report Not Submitted!","Information")})}else Swal.fire({icon:"error",title:"Oops...",text:"All selected fields are required!",footer:"Select and try again!"})}function remove(n){var i=$(n).closest("TR"),r=$("TD",i).eq(0).html(),t=Number($("TD",i).eq(3).html());Swal.fire({title:"Are you sure?",text:"Do you want to delete "+r+"?",type:"warning",showCancelButton:!0,confirmButtonColor:"$success",cancelButtonColor:"$danger",confirmButtonText:"Yes, delete it!"}).then(n=>{var u,f,s,h,c,l;if(n.value){u=0;f=0;f=$("#totalincomebal").val();u=$("#netbalance").val();f-=t;u-=t;totalbal-=t;netbalan-=t;var e=0,o=0,a=Number($("#Driver_Percent").val()),v=Number($("#Park_Percent").val());e=a/100*t;o=v/100*t;e>0&&o>0&&(s=$("#Daily_DriverSavings").val(),h=$("#Daily_ParkOperation").val(),$("#Daily_DriverSavings").val(s-e),$("#Daily_ParkOperation").val(h-o),c=$("#lodgetotalincome").val(),$("#lodgetotalincome").val(c-t));$("#netbalance").val(u);$("#totalincomebal").val(f);l=$("#dailyreporter")[0];l.deleteRow(i[0].rowIndex);Swal.fire("Deleted!",r+" destination removed!","success")}})}function blockcallback(){$.blockUI({message:'<div class="bs-spinner mt-4 mt-lg-0"><div class= "spinner-border text-success mr-2 mt-2" style="width: 10rem; height: 10rem;" role="status"><span class="sr-only">Loading...<\/span><\/div>',fadeIn:800,overlayCSS:{backgroundColor:"#1b2024",opacity:.8,zIndex:1200,cursor:"wait"},css:{border:0,color:"#fff",zIndex:1201,padding:0,backgroundColor:"transparent"},onBlock:function(){}})}var netbalan=0,totalbal=0,additionincome=0,expenses=0,percent=$("#Comm_Percent").val();$(function(){"use strict";$("#form-horizontal").steps({headerTag:"h3",bodyTag:"fieldset",transitionEffect:"slide",onStepChanged:function(n,t){t===3&&($("#form-horizontal").find('a[href="#finish"]').remove(),$("#form-horizontal .actions li:last-child").append('<button type="button" onclick="postreport();" id="submitreport" class="btn btn-primary btn-sm"><i class="far fa-paper-plane"><\/i> Submit Report<\/button>'));t===2&&$("#submitreport").remove()}});$("#Daily_ReportedDate").bootstrapMaterialDatePicker({weekStart:0,time:!1})});